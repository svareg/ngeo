{"version":3,"sources":["webpack:///webpack/bootstrap","webpack:///./contribs/gmf/examples/editfeature.js"],"names":["module","angular","gmfAuthenticationModule","name","gmfEditingEditFeature","gmfMapComponent","value","appURL","GMF_DEMO","GMF_LAYERS","constant","MainController","$scope","gmfEditFeature","gmfUser","scope_","editFeature_","wmsSource_","olSourceImageWMS","projection","undefined","url","MAPSERVER_PROXY","params","wmsLayer_","olLayerImage","source","pixelBuffer_","layerId_","feature","pending","map","olMap","layers","olLayerTile","olSourceOSM","view","olView","EPSG21781","resolutions","center","zoom","on","handleMapSingleClick_","bind","$","tooltip","container","trigger","prototype","evt","coordinate","getView","resolution","getResolution","buffer","extent","olExtent","getFeaturesInExtent","then","handleGetFeatures_","$apply","features","length","insertFeature","size","getSize","calculateExtent","bottomLeft","topRight","left","bottom","right","top","deltaX","deltaY","Math","random","olFeature","olGeomMultiPoint","insertFeatures","handleEditFeature_","updateFeature","console","assert","set","deleteFeature","resp","refreshWMSLayer_","updateParams","controller"],"mappings":";AAAA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,gBAAQ,oBAAoB;AAC5B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,yBAAiB,4BAA4B;AAC7C;AACA;AACA,0BAAkB,2BAA2B;AAC7C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;;AAGA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA,kDAA0C,gCAAgC;AAC1E;AACA;;AAEA;AACA;AACA;AACA,gEAAwD,kBAAkB;AAC1E;AACA,yDAAiD,cAAc;AAC/D;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iDAAyC,iCAAiC;AAC1E,wHAAgH,mBAAmB,EAAE;AACrI;AACA;;AAEA;AACA;AACA;AACA,mCAA2B,0BAA0B,EAAE;AACvD,yCAAiC,eAAe;AAChD;AACA;AACA;;AAEA;AACA,8DAAsD,+DAA+D;;AAErH;AACA;;AAEA;AACA;AACA;AACA;AACA,wBAAgB,uBAAuB;AACvC;;;AAGA;AACA;AACA;AACA;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;ACtJA;AACA;AACA;AACA;AACA;AAEA;AACA;AAEA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAOA,IAAMA,MAAM,GAAGC,8CAAO,CAACD,MAAR,CAAe,QAAf,EAAyB,CACtC,SADsC,EAEtCE,oEAAuB,CAACC,IAFc,EAGtCC,kEAAqB,CAACD,IAHgB,EAItCE,4DAAe,CAACF,IAJsB,CAAzB,CAAf;AAQAH,MAAM,CAACM,KAAP,CAAa,uBAAb,EAAsCC,+CAAM,CAACC,QAA7C;AACAR,MAAM,CAACM,KAAP,CAAa,cAAb,EAA6BC,+CAAM,CAACE,UAApC;AAEAT,MAAM,CAACU,QAAP,CAAgB,cAAhB,EAAgC,MAAhC;AACAV,MAAM,CAACU,QAAP,CAAgB,qBAAhB,EAAuC,uCAAvC;;AAUA,SAASC,cAAT,CAAwBC,MAAxB,EAAgCC,cAAhC,EAAgDC,OAAhD,EAAyD;AAMvD,OAAKC,MAAL,GAAcH,MAAd;AAKA,OAAKI,YAAL,GAAoBH,cAApB;AAKA,OAAKC,OAAL,GAAeA,OAAf;AAMA,OAAKG,UAAL,GAAkB,IAAIC,8DAAJ,CAAqB;AACrCC,cAAU,EAAEC,SADyB;AAErCC,OAAG,EAAEd,+CAAM,CAACe,eAFyB;AAGrCC,UAAM,EAAE;AAAC,gBAAU;AAAX;AAH6B,GAArB,CAAlB;AAUA,OAAKC,SAAL,GAAiB,IAAIC,0DAAJ,CAAiB;AAChCC,UAAM,EAAE,KAAKT;AADmB,GAAjB,CAAjB;AAQA,OAAKU,YAAL,GAAoB,EAApB;AAMA,OAAKC,QAAL,GAAgB,GAAhB;AAKA,OAAKC,OAAL,GAAe,IAAf;AAKA,OAAKC,OAAL,GAAe,KAAf;AAKA,OAAKC,GAAL,GAAW,IAAIC,iDAAJ,CAAU;AACnBC,UAAM,EAAE,CACN,IAAIC,yDAAJ,CAAgB;AACdR,YAAM,EAAE,IAAIS,yDAAJ;AADM,KAAhB,CADM,EAIN,KAAKX,SAJC,CADW;AAOnBY,QAAI,EAAE,IAAIC,mDAAJ,CAAW;AACflB,gBAAU,EAAEmB,yEADG;AAEfC,iBAAW,EAAE,CAAC,GAAD,EAAM,GAAN,EAAW,EAAX,EAAe,EAAf,EAAmB,EAAnB,EAAuB,CAAvB,EAA0B,GAA1B,EAA+B,CAA/B,EAAkC,CAAlC,EAAqC,GAArC,CAFE;AAGfC,YAAM,EAAE,CAAC,MAAD,EAAS,MAAT,CAHO;AAIfC,UAAI,EAAE;AAJS,KAAX;AAPa,GAAV,CAAX;AAeA,OAAKV,GAAL,CAASW,EAAT,CAAY,aAAZ,EAA2B,KAAKC,qBAAL,CAA2BC,IAA3B,CAAgC,IAAhC,CAA3B;AAGAC,GAAC,CAAC,yBAAD,CAAD,CAA6BC,OAA7B,CAAqC;AACnCC,aAAS,EAAE,MADwB;AAEnCC,WAAO,EAAE;AAF0B,GAArC;AAID;;AAODrC,cAAc,CAACsC,SAAf,CAAyBN,qBAAzB,GAAiD,UAASO,GAAT,EAAc;AAG7D,MAAMC,UAAU,GAAGD,GAAG,CAACC,UAAvB;AACA,MAAMpB,GAAG,GAAG,KAAKA,GAAjB;AACA,MAAMK,IAAI,GAAGL,GAAG,CAACqB,OAAJ,EAAb;AACA,MAAMC,UAAU,GAAGjB,IAAI,CAACkB,aAAL,EAAnB;AACA,MAAMC,MAAM,GAAGF,UAAU,GAAG,KAAK1B,YAAjC;AACA,MAAM6B,MAAM,GAAGC,oDAAA,CACb,CAACN,UAAU,CAAC,CAAD,CAAX,EAAgBA,UAAU,CAAC,CAAD,CAA1B,EAA+BA,UAAU,CAAC,CAAD,CAAzC,EAA8CA,UAAU,CAAC,CAAD,CAAxD,CADa,EAEbI,MAFa,CAAf;AAKA,OAAKvC,YAAL,CAAkB0C,mBAAlB,CAAsC,CAAC,KAAK9B,QAAN,CAAtC,EAAuD4B,MAAvD,EAA+DG,IAA/D,CACE,KAAKC,kBAAL,CAAwBhB,IAAxB,CAA6B,IAA7B,CADF;AAIA,OAAKf,OAAL,GAAe,IAAf;AAGA,OAAKC,OAAL,GAAe,IAAf;AAEA,OAAKf,MAAL,CAAY8C,MAAZ;AACD,CAvBD;;AA8BAlD,cAAc,CAACsC,SAAf,CAAyBW,kBAAzB,GAA8C,UAASE,QAAT,EAAmB;AAC/D,OAAKhC,OAAL,GAAe,KAAf;;AAEA,MAAIgC,QAAQ,CAACC,MAAb,EAAqB;AACnB,SAAKlC,OAAL,GAAeiC,QAAQ,CAAC,CAAD,CAAvB;AACD;AACF,CAND;;AAYAnD,cAAc,CAACsC,SAAf,CAAyBe,aAAzB,GAAyC,YAAW;AAElD,OAAKlC,OAAL,GAAe,IAAf;AAGA,MAAMC,GAAG,GAAG,KAAKA,GAAjB;AACA,MAAMK,IAAI,GAAGL,GAAG,CAACqB,OAAJ,EAAb;AACA,MAAMC,UAAU,GAAGjB,IAAI,CAACkB,aAAL,EAAnB;AACA,MAAMC,MAAM,GAAGF,UAAU,GAAG,CAAC,EAA7B;AACA,MAAMY,IAAI,GAAmClC,GAAG,CAACmC,OAAJ,EAA7C;AACA,MAAMV,MAAM,GAAGC,oDAAA,CACbrB,IAAI,CAAC+B,eAAL,CAAqBF,IAArB,CADa,EAEbV,MAFa,CAAf;AAIA,MAAMa,UAAU,GAAGX,2DAAA,CAAuBD,MAAvB,CAAnB;AACA,MAAMa,QAAQ,GAAGZ,yDAAA,CAAqBD,MAArB,CAAjB;AACA,MAAMc,IAAI,GAAGF,UAAU,CAAC,CAAD,CAAvB;AACA,MAAMG,MAAM,GAAGH,UAAU,CAAC,CAAD,CAAzB;AACA,MAAMI,KAAK,GAAGH,QAAQ,CAAC,CAAD,CAAtB;AACA,MAAMI,GAAG,GAAGJ,QAAQ,CAAC,CAAD,CAApB;AACA,MAAMK,MAAM,GAAGF,KAAK,GAAGF,IAAvB;AACA,MAAMK,MAAM,GAAGF,GAAG,GAAGF,MAArB;AACA,MAAMpB,UAAU,GAAG,CACjBmB,IAAI,GAAGM,IAAI,CAACC,MAAL,KAAgBH,MADN,EAEjBH,MAAM,GAAGK,IAAI,CAACC,MAAL,KAAgBF,MAFR,CAAnB;AAKA,MAAM9C,OAAO,GAAG,IAAIiD,qDAAJ,CAAc;AAC5B,gBAAY,IAAIC,8DAAJ,CAAqB,CAAC5B,UAAD,CAArB,CADgB;AAE5B,YAAQ;AAFoB,GAAd,CAAhB;AAKA,OAAKtB,OAAL,GAAe,IAAf;AAGA,OAAKb,YAAL,CAAkBgE,cAAlB,CACE,KAAKpD,QADP,EAEE,CAACC,OAAD,CAFF,EAGE8B,IAHF,CAIE,KAAKsB,kBAAL,CAAwBrC,IAAxB,CAA6B,IAA7B,CAJF;AAMD,CAzCD;;AA+CAjC,cAAc,CAACsC,SAAf,CAAyBiC,aAAzB,GAAyC,YAAW;AAElDC,SAAO,CAACC,MAAR,CAAe,KAAKvD,OAApB;AAEA,OAAKC,OAAL,GAAe,IAAf;AAGA,OAAKD,OAAL,CAAawD,GAAb,CAAiB,MAAjB,EAAyB,cAAzB;AAGA,OAAKrE,YAAL,CAAkBkE,aAAlB,CACE,KAAKtD,QADP,EAEE,KAAKC,OAFP,EAGE8B,IAHF,CAIE,KAAKsB,kBAAL,CAAwBrC,IAAxB,CAA6B,IAA7B,CAJF;AAMD,CAhBD;;AAsBAjC,cAAc,CAACsC,SAAf,CAAyBqC,aAAzB,GAAyC,YAAW;AAElDH,SAAO,CAACC,MAAR,CAAe,KAAKvD,OAApB;AAGA,OAAKb,YAAL,CAAkBsE,aAAlB,CACE,KAAK1D,QADP,EAEE,KAAKC,OAFP,EAGE8B,IAHF,CAIE,KAAKsB,kBAAL,CAAwBrC,IAAxB,CAA6B,IAA7B,CAJF;AAQA,OAAKf,OAAL,GAAe,IAAf;AACD,CAdD;;AAsBAlB,cAAc,CAACsC,SAAf,CAAyBgC,kBAAzB,GAA8C,UAASM,IAAT,EAAe;AAC3D,OAAKzD,OAAL,GAAe,KAAf;AACA,OAAK0D,gBAAL;AACD,CAHD;;AASA7E,cAAc,CAACsC,SAAf,CAAyBuC,gBAAzB,GAA4C,YAAW;AACrD,OAAKvE,UAAL,CAAgBwE,YAAhB,CAA6B;AAC3B,cAAUb,IAAI,CAACC,MAAL;AADiB,GAA7B;AAGD,CAJD;;AAOA7E,MAAM,CAAC0F,UAAP,CAAkB,gBAAlB,EAAoC/E,cAApC;AAGeX,qEAAf,E","file":"editfeature.js","sourcesContent":[" \t// install a JSONP callback for chunk loading\n \tfunction webpackJsonpCallback(data) {\n \t\tvar chunkIds = data[0];\n \t\tvar moreModules = data[1];\n \t\tvar executeModules = data[2];\n\n \t\t// add \"moreModules\" to the modules object,\n \t\t// then flag all \"chunkIds\" as loaded and fire callback\n \t\tvar moduleId, chunkId, i = 0, resolves = [];\n \t\tfor(;i < chunkIds.length; i++) {\n \t\t\tchunkId = chunkIds[i];\n \t\t\tif(installedChunks[chunkId]) {\n \t\t\t\tresolves.push(installedChunks[chunkId][0]);\n \t\t\t}\n \t\t\tinstalledChunks[chunkId] = 0;\n \t\t}\n \t\tfor(moduleId in moreModules) {\n \t\t\tif(Object.prototype.hasOwnProperty.call(moreModules, moduleId)) {\n \t\t\t\tmodules[moduleId] = moreModules[moduleId];\n \t\t\t}\n \t\t}\n \t\tif(parentJsonpFunction) parentJsonpFunction(data);\n\n \t\twhile(resolves.length) {\n \t\t\tresolves.shift()();\n \t\t}\n\n \t\t// add entry modules from loaded chunk to deferred list\n \t\tdeferredModules.push.apply(deferredModules, executeModules || []);\n\n \t\t// run deferred modules when all chunks ready\n \t\treturn checkDeferredModules();\n \t};\n \tfunction checkDeferredModules() {\n \t\tvar result;\n \t\tfor(var i = 0; i < deferredModules.length; i++) {\n \t\t\tvar deferredModule = deferredModules[i];\n \t\t\tvar fulfilled = true;\n \t\t\tfor(var j = 1; j < deferredModule.length; j++) {\n \t\t\t\tvar depId = deferredModule[j];\n \t\t\t\tif(installedChunks[depId] !== 0) fulfilled = false;\n \t\t\t}\n \t\t\tif(fulfilled) {\n \t\t\t\tdeferredModules.splice(i--, 1);\n \t\t\t\tresult = __webpack_require__(__webpack_require__.s = deferredModule[0]);\n \t\t\t}\n \t\t}\n \t\treturn result;\n \t}\n\n \t// The module cache\n \tvar installedModules = {};\n\n \t// object to store loaded and loading chunks\n \t// undefined = chunk not loaded, null = chunk preloaded/prefetched\n \t// Promise = chunk loading, 0 = chunk loaded\n \tvar installedChunks = {\n \t\t\"editfeature\": 0\n \t};\n\n \tvar deferredModules = [];\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n \tvar jsonpArray = window[\"webpackJsonp\"] = window[\"webpackJsonp\"] || [];\n \tvar oldJsonpFunction = jsonpArray.push.bind(jsonpArray);\n \tjsonpArray.push = webpackJsonpCallback;\n \tjsonpArray = jsonpArray.slice();\n \tfor(var i = 0; i < jsonpArray.length; i++) webpackJsonpCallback(jsonpArray[i]);\n \tvar parentJsonpFunction = oldJsonpFunction;\n\n\n \t// add entry module to deferred list\n \tdeferredModules.push([7,\"commons\"]);\n \t// run deferred modules when ready\n \treturn checkDeferredModules();\n","import angular from 'angular';\nimport appURL from './url.js';\nimport './editfeature.css';\nimport 'jquery-ui/ui/widgets/tooltip.js';\nimport EPSG21781 from '@geoblocks/proj/src/EPSG_21781.js';\n\nimport gmfAuthenticationModule from 'gmf/authentication/module.js';\nimport gmfEditingEditFeature from 'gmf/editing/EditFeature.js';\n\nimport gmfMapComponent from 'gmf/map/component.js';\n\nimport olFeature from 'ol/Feature.js';\nimport olMap from 'ol/Map.js';\nimport olView from 'ol/View.js';\nimport * as olExtent from 'ol/extent.js';\nimport olGeomMultiPoint from 'ol/geom/MultiPoint.js';\nimport olLayerTile from 'ol/layer/Tile.js';\nimport olLayerImage from 'ol/layer/Image.js';\nimport olSourceOSM from 'ol/source/OSM.js';\nimport olSourceImageWMS from 'ol/source/ImageWMS.js';\n\n\n/**\n * @type {!angular.IModule}\n * @hidden\n */\nconst module = angular.module('gmfapp', [\n  'gettext',\n  gmfAuthenticationModule.name,\n  gmfEditingEditFeature.name,\n  gmfMapComponent.name,\n]);\n\n\nmodule.value('authenticationBaseUrl', appURL.GMF_DEMO);\nmodule.value('gmfLayersUrl', appURL.GMF_LAYERS);\n\nmodule.constant('defaultTheme', 'Demo');\nmodule.constant('angularLocaleScript', '../build/angular-locale_{{locale}}.js');\n\n\n/**\n * @param {!angular.IScope} $scope Angular scope.\n * @param {import(\"gmf/editing/EditFeature.js\").EditingEditFeature} gmfEditFeature Gmf edit feature service.\n * @param {import('gmf/authentication/Service.js').User} gmfUser User.\n * @constructor\n * @ngInject\n */\nfunction MainController($scope, gmfEditFeature, gmfUser) {\n\n  /**\n   * @type {!angular.IScope}\n   * @private\n   */\n  this.scope_ = $scope;\n\n  /**\n   * @type {import(\"gmf/editing/EditFeature.js\").EditingEditFeature}\n   */\n  this.editFeature_ = gmfEditFeature;\n\n  /**\n   * @type {import('gmf/authentication/Service.js').User}\n   */\n  this.gmfUser = gmfUser;\n\n  /**\n   * @type {import(\"ol/source/ImageWMS.js\").default}\n   * @private\n   */\n  this.wmsSource_ = new olSourceImageWMS({\n    projection: undefined, // should be removed in next OL version\n    url: appURL.MAPSERVER_PROXY,\n    params: {'LAYERS': 'point'}\n  });\n\n  /**\n   * @type {import(\"ol/layer/Image.js\").default}\n   * @private\n   */\n  this.wmsLayer_ = new olLayerImage({\n    source: this.wmsSource_\n  });\n\n  /**\n   * @type {number}\n   * @private\n   */\n  this.pixelBuffer_ = 10;\n\n  /**\n   * @type {number}\n   * @private\n   */\n  this.layerId_ = 113;\n\n  /**\n   * @type {import(\"ol/Feature.js\").default}\n   */\n  this.feature = null;\n\n  /**\n   * @type {boolean}\n   */\n  this.pending = false;\n\n  /**\n   * @type {import(\"ol/Map.js\").default}\n   */\n  this.map = new olMap({\n    layers: [\n      new olLayerTile({\n        source: new olSourceOSM()\n      }),\n      this.wmsLayer_\n    ],\n    view: new olView({\n      projection: EPSG21781,\n      resolutions: [200, 100, 50, 20, 10, 5, 2.5, 2, 1, 0.5],\n      center: [537635, 152640],\n      zoom: 2\n    })\n  });\n\n  this.map.on('singleclick', this.handleMapSingleClick_.bind(this));\n\n  // initialize tooltips\n  $('[data-toggle=\"tooltip\"]').tooltip({\n    container: 'body',\n    trigger: 'hover'\n  });\n}\n\n\n/**\n * @param {import(\"ol/MapBrowserEvent.js\").default} evt MapBrowser event\n * @private\n */\nMainController.prototype.handleMapSingleClick_ = function(evt) {\n\n  // (1) Launch query to fetch new features\n  const coordinate = evt.coordinate;\n  const map = this.map;\n  const view = map.getView();\n  const resolution = view.getResolution();\n  const buffer = resolution * this.pixelBuffer_;\n  const extent = olExtent.buffer(\n    [coordinate[0], coordinate[1], coordinate[0], coordinate[1]],\n    buffer\n  );\n\n  this.editFeature_.getFeaturesInExtent([this.layerId_], extent).then(\n    this.handleGetFeatures_.bind(this));\n\n  // (2) Clear any previously selected feature\n  this.feature = null;\n\n  // (3) Pending\n  this.pending = true;\n\n  this.scope_.$apply();\n};\n\n\n/**\n * @param {Array.<import(\"ol/Feature.js\").default>} features Features.\n * @private\n */\nMainController.prototype.handleGetFeatures_ = function(features) {\n  this.pending = false;\n\n  if (features.length) {\n    this.feature = features[0];\n  }\n};\n\n\n/**\n * Insert a new feature at a random location.\n */\nMainController.prototype.insertFeature = function() {\n\n  this.pending = true;\n\n  // (1) Create a randomly located feature\n  const map = this.map;\n  const view = map.getView();\n  const resolution = view.getResolution();\n  const buffer = resolution * -50; // 50 pixel buffer inside the extent\n  const size = /** @type {!Array.<number>} */ (map.getSize());\n  const extent = olExtent.buffer(\n    view.calculateExtent(size),\n    buffer\n  );\n  const bottomLeft = olExtent.getBottomLeft(extent);\n  const topRight = olExtent.getTopRight(extent);\n  const left = bottomLeft[0];\n  const bottom = bottomLeft[1];\n  const right = topRight[0];\n  const top = topRight[1];\n  const deltaX = right - left;\n  const deltaY = top - bottom;\n  const coordinate = [\n    left + Math.random() * deltaX,\n    bottom + Math.random() * deltaY\n  ];\n\n  const feature = new olFeature({\n    'geometry': new olGeomMultiPoint([coordinate]),\n    'name': 'New point'\n  });\n\n  this.feature = null; // clear selected feature\n\n  // (2) Launch request\n  this.editFeature_.insertFeatures(\n    this.layerId_,\n    [feature]\n  ).then(\n    this.handleEditFeature_.bind(this)\n  );\n};\n\n\n/**\n * Update the currently selected feature with a new name.\n */\nMainController.prototype.updateFeature = function() {\n\n  console.assert(this.feature);\n\n  this.pending = true;\n\n  // (1) Update name\n  this.feature.set('name', 'Updated name');\n\n  // (2) Launch request\n  this.editFeature_.updateFeature(\n    this.layerId_,\n    this.feature\n  ).then(\n    this.handleEditFeature_.bind(this)\n  );\n};\n\n\n/**\n * Delete currently selected feature.\n */\nMainController.prototype.deleteFeature = function() {\n\n  console.assert(this.feature);\n\n  // (1) Launch request\n  this.editFeature_.deleteFeature(\n    this.layerId_,\n    this.feature\n  ).then(\n    this.handleEditFeature_.bind(this)\n  );\n\n  // (2) Reset selected feature\n  this.feature = null;\n};\n\n\n/**\n * Called after an insert, update or delete request.\n * @param {angular.IHttpResponse} resp Ajax response.\n * @private\n */\nMainController.prototype.handleEditFeature_ = function(resp) {\n  this.pending = false;\n  this.refreshWMSLayer_();\n};\n\n\n/**\n * @private\n */\nMainController.prototype.refreshWMSLayer_ = function() {\n  this.wmsSource_.updateParams({\n    'random': Math.random()\n  });\n};\n\n\nmodule.controller('MainController', MainController);\n\n\nexport default module;\n"],"sourceRoot":""}